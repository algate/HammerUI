(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-hammer-user-user-weather"],{"1a66":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("6b54"),a("a481");var i=a("fa997"),o={data:function(){return{inputShowed:!1,inputVal:"",amapPlugin:null,key:this.$hammer.$constant.amapWxKey,lat:39.9776,lng:116.35231,covers:[],address:[],scrollH:256,weather:{}}},onLoad:function(t){var e=this;this.amapPlugin=new i.AMapWX({key:this.key});setTimeout((function(){var t=uni.getSystemInfoSync().windowHeight;e.scrollH=t-44-uni.upx2px(600),e.getLocation((function(){e.getWeather()}))}),300)},methods:{trim:function(t){return t?t.toString().replace(/(^\s*)|(\s*$)/g,""):t},showInput:function(){this.inputShowed=!0},hideInput:function(){this.inputVal="",this.inputShowed=!1,uni.hideKeyboard()},clearInput:function(){this.inputVal=""},inputTyping:function(t){this.inputVal=t.detail.value},getLocation:function(t){var e=this;this.amapPlugin.getRegeo({success:function(a){e.lng=a[0].longitude,e.lat=a[0].latitude,t()},fail:function(e){t()}})},getWeather:function(t){uni.showLoading({title:"加载中..."});var e=this;setTimeout((function(){e.amapPlugin.getWeather({location:"",success:function(t){e.weather=t,uni.hideLoading()},fail:function(t){uni.showToast({title:"获取位置信息失败，请检查是否打开位置权限"}),uni.hideLoading()}})}),0)},bindInput:function(t){var e=t.detail.value;this.getPoiAround(e)}}};e.default=o},4992:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"maps-container"},[a("v-uni-view",{staticClass:"search-bar"},[a("v-uni-view",{staticClass:"search-bar-form"},[a("v-uni-view",{staticClass:"search-bar-box"},[a("hammer-icon",{attrs:{name:"search",size:16}}),a("v-uni-input",{staticClass:"search-bar-input",attrs:{"confirm-type":"search",placeholder:"请输入您的目的地",value:t.inputVal,focus:t.inputShowed},on:{confirm:function(e){e=t.$handleEvent(e),t.bindInput(e)},input:function(e){e=t.$handleEvent(e),t.inputTyping(e)}}}),t.inputVal?a("v-uni-view",{staticClass:"icon-clear",on:{click:function(e){e=t.$handleEvent(e),t.clearInput(e)}}},[a("hammer-icon",{attrs:{name:"close",size:14}})],1):t._e()],1),a("v-uni-label",{directives:[{name:"show",rawName:"v-show",value:!t.inputShowed,expression:"!inputShowed"}],staticClass:"search-bar-label",on:{click:function(e){e=t.$handleEvent(e),t.showInput(e)}}},[a("hammer-icon",{attrs:{name:"search",size:16}}),a("v-uni-view",{staticClass:"search-bar-text"},[t._v("请输入您的目的地")])],1)],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.inputShowed,expression:"inputShowed"}],staticClass:"cancel-btn",on:{click:function(e){e=t.$handleEvent(e),t.hideInput(e)}}},[t._v("取消")])],1),a("v-uni-map",{attrs:{latitude:t.lat,longitude:t.lng,markers:t.covers,scale:12}}),a("v-uni-view",{staticClass:"box weather"},[t.weather.city?a("v-uni-text",[t._v(t._s(t.weather.city.text)+" : "+t._s(t.weather.city.data))]):t._e(),t.weather.weather?a("v-uni-text",[t._v(t._s(t.weather.weather.text)+" : "+t._s(t.weather.weather.data))]):t._e(),t.weather.temperature?a("v-uni-text",[t._v(t._s(t.weather.temperature.text)+" : "+t._s(t.weather.temperature.data)+" ℃")]):t._e(),t.weather.winddirection?a("v-uni-text",[t._v("风速 : "+t._s(t.weather.winddirection.data)+" "+t._s(t.weather.windpower.data))]):t._e(),t.weather.humidity?a("v-uni-text",[t._v(t._s(t.weather.humidity.text)+" : "+t._s(t.weather.humidity.data))]):t._e()],1)],1)},o=[];a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return o}))},"4b8c":function(t,e,a){e=t.exports=a("24fb")(!1),e.push([t.i,'uni-page-body[data-v-532dfb3e]{height:100%}uni-input[data-v-532dfb3e]{overflow:inherit}.tui-list[data-v-532dfb3e]{background-color:#fff;position:relative;width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;padding-bottom:env(safe-area-inset-bottom)}.tui-list-cell[data-v-532dfb3e]{position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.tui-list-cell[data-v-532dfb3e]:after{content:"";position:absolute;border-bottom:%?1?% solid #eaeef1;-webkit-transform:scaleY(.5);transform:scaleY(.5);bottom:0;right:0;left:%?30?%}.tui-cell-last[data-v-532dfb3e]:after{border-bottom:0}.maps-container[data-v-532dfb3e]{height:100%;overflow:hidden}uni-map[data-v-532dfb3e]{width:100%;height:%?600?%}.box.weather[data-v-532dfb3e]{height:calc(100vh - %?600?% - 46px);background:#00ab98;color:#fff;padding-top:%?80?%;padding-left:%?100?%;line-height:%?60?%}.box.weather uni-text[data-v-532dfb3e]{display:block}.opcity[data-v-532dfb3e]{opacity:.5}.search-bar[data-v-532dfb3e]{position:relative;padding:8px 10px;display:-webkit-flex;display:-webkit-box;display:flex;box-sizing:border-box;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background-color:#fff}.icon-search[data-v-532dfb3e]{margin-right:8px;font-size:inherit;height:18px;position:relative;top:3px}.icon-search-in-box[data-v-532dfb3e]{position:absolute;left:10px;top:6px}.search-bar-form[data-v-532dfb3e]{position:relative;-webkit-box-flex:1;-webkit-flex:auto;flex:auto;border-radius:5px;background:#f0f0f0}.search-bar-text[data-v-532dfb3e]{display:inline-block;font-size:14px}.search-bar-box[data-v-532dfb3e]{position:relative;padding-left:30px;padding-right:30px;width:100%;box-sizing:border-box;z-index:1}.search-bar-input[data-v-532dfb3e]{height:30px;line-height:30px;font-size:14px;display:inline-block}.icon-clear[data-v-532dfb3e]{position:absolute;top:0;right:0;padding:7px 8px;font-size:0}.search-bar-label[data-v-532dfb3e]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:2;border-radius:3px;text-align:center;color:#9b9b9b;background:#f0f0f0;line-height:30px}.cancel-btn[data-v-532dfb3e]{margin-left:10px;line-height:30px;color:#5982fd;white-space:nowrap;font-size:15px}.tui-list-cell[data-v-532dfb3e]{display:initial;padding:%?30?%}.addr-title[data-v-532dfb3e]{font-size:%?30?%;line-height:%?40?%;color:#000;font-weight:700;width:100%;padding-bottom:%?20?%}.addr-box[data-v-532dfb3e]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:end;-webkit-align-items:flex-end;align-items:flex-end;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.addr-detail[data-v-532dfb3e]{width:%?450?%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;/*! autoprefixer: ignore next */-webkit-box-orient:vertical;font-size:%?24?%;color:#999}.distance[data-v-532dfb3e]{color:#5982fd;padding-right:%?6?%}.addr-opera[data-v-532dfb3e]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.opera-box[data-v-532dfb3e]{text-align:center;margin-left:%?26?%}.mini-img[data-v-532dfb3e]{width:%?44?%;height:%?44?%}.text[data-v-532dfb3e]{color:#333;font-size:%?24?%;line-height:%?30?%}',""])},"4e20":function(t,e,a){var i=a("4b8c");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=a("4f06").default;o("20a16be7",i,!0,{sourceMap:!1,shadowMode:!1})},"5fe6":function(t,e,a){"use strict";a.r(e);var i=a("1a66"),o=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=o.a},"6e7e":function(t,e,a){"use strict";a.r(e);var i=a("4992"),o=a("5fe6");for(var n in o)"default"!==n&&function(t){a.d(e,t,(function(){return o[t]}))}(n);a("cfad");var s=a("2877"),r=Object(s["a"])(o["default"],i["a"],i["b"],!1,null,"532dfb3e",null);e["default"]=r.exports},cfad:function(t,e,a){"use strict";var i=a("4e20"),o=a.n(i);o.a},fa997:function(t,e,a){"use strict";function i(t){this.key=t.key,this.requestConfig={key:t.key,s:"rsx",platform:"WXJS",appname:t.key,sdkversion:"1.2.0",logversion:"2.0"}}a("28a5"),i.prototype.getWxLocation=function(t,e){wx.getLocation({type:"gcj02",success:function(t){var a=t.longitude+","+t.latitude;wx.setStorage({key:"userLocation",data:a}),e(a)},fail:function(a){wx.getStorage({key:"userLocation",success:function(t){t.data&&e(t.data)}}),t.fail({errCode:"0",errMsg:a.errMsg||""})}})},i.prototype.getRegeo=function(t){function e(e){var i=a.requestConfig;wx.request({url:"https://restapi.amap.com/v3/geocode/regeo",data:{key:a.key,location:e,extensions:"all",s:i.s,platform:i.platform,appname:a.key,sdkversion:i.sdkversion,logversion:i.logversion},method:"GET",header:{"content-type":"application/json"},success:function(a){var i,o,n,s,r,d,c,l,p;a.data.status&&"1"==a.data.status?(i=a.data.regeocode,o=i.addressComponent,n=[],s="",i&&i.roads[0]&&i.roads[0].name&&(s=i.roads[0].name+"附近"),r=e.split(",")[0],d=e.split(",")[1],i.pois&&i.pois[0]&&(s=i.pois[0].name+"附近",c=i.pois[0].location,c&&(r=parseFloat(c.split(",")[0]),d=parseFloat(c.split(",")[1]))),o.provice&&n.push(o.provice),o.city&&n.push(o.city),o.district&&n.push(o.district),o.streetNumber&&o.streetNumber.street&&o.streetNumber.number?(n.push(o.streetNumber.street),n.push(o.streetNumber.number)):(l="",i&&i.roads[0]&&i.roads[0].name&&(l=i.roads[0].name),n.push(l)),n=n.join(""),p=[{iconPath:t.iconPath,width:t.iconWidth,height:t.iconHeight,name:n,desc:s,longitude:r,latitude:d,id:0,regeocodeData:i}],t.success(p)):t.fail({errCode:a.data.infocode,errMsg:a.data.info})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})}var a=this;t.location?e(t.location):a.getWxLocation(t,(function(t){e(t)}))},i.prototype.getWeather=function(t){function e(e){var a="base";t.type&&"forecast"==t.type&&(a="all"),wx.request({url:"https://restapi.amap.com/v3/weather/weatherInfo",data:{key:i.key,city:e,extensions:a,s:o.s,platform:o.platform,appname:i.key,sdkversion:o.sdkversion,logversion:o.logversion},method:"GET",header:{"content-type":"application/json"},success:function(e){function a(t){var e={city:{text:"城市",data:t.city},weather:{text:"天气",data:t.weather},temperature:{text:"温度",data:t.temperature},winddirection:{text:"风向",data:t.winddirection+"风"},windpower:{text:"风力",data:t.windpower+"级"},humidity:{text:"湿度",data:t.humidity+"%"}};return e}var i,o;e.data.status&&"1"==e.data.status?e.data.lives?(i=e.data.lives,i&&i.length>0&&(i=i[0],o=a(i),o["liveData"]=i,t.success(o))):e.data.forecasts&&e.data.forecasts[0]&&t.success({forecast:e.data.forecasts[0]}):t.fail({errCode:e.data.infocode,errMsg:e.data.info})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})}function a(a){wx.request({url:"https://restapi.amap.com/v3/geocode/regeo",data:{key:i.key,location:a,extensions:"all",s:o.s,platform:o.platform,appname:i.key,sdkversion:o.sdkversion,logversion:o.logversion},method:"GET",header:{"content-type":"application/json"},success:function(a){var i,o;a.data.status&&"1"==a.data.status?(o=a.data.regeocode,o.addressComponent?i=o.addressComponent.adcode:o.aois&&o.aois.length>0&&(i=o.aois[0].adcode),e(i)):t.fail({errCode:a.data.infocode,errMsg:a.data.info})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})}var i=this,o=i.requestConfig;t.city?e(t.city):i.getWxLocation(t,(function(t){a(t)}))},i.prototype.getPoiAround=function(t){function e(e){var o={key:a.key,location:e,s:i.s,platform:i.platform,appname:a.key,sdkversion:i.sdkversion,logversion:i.logversion};t.querytypes&&(o["types"]=t.querytypes),t.querykeywords&&(o["keywords"]=t.querykeywords),wx.request({url:"https://restapi.amap.com/v3/place/around",data:o,method:"GET",header:{"content-type":"application/json"},success:function(e){var a,i,o,n;if(e.data.status&&"1"==e.data.status){if(e=e.data,e&&e.pois){for(a=[],i=0;i<e.pois.length;i++)o=0==i?t.iconPathSelected:t.iconPath,a.push({latitude:parseFloat(e.pois[i].location.split(",")[1]),longitude:parseFloat(e.pois[i].location.split(",")[0]),iconPath:o,width:22,height:32,id:i,name:e.pois[i].name,address:e.pois[i].address});n={markers:a,poisData:e.pois},t.success(n)}}else t.fail({errCode:e.data.infocode,errMsg:e.data.info})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})}var a=this,i=a.requestConfig;t.location?e(t.location):a.getWxLocation(t,(function(t){e(t)}))},i.prototype.getStaticmap=function(t){function e(e){o.push("location="+e),t.zoom&&o.push("zoom="+t.zoom),t.size&&o.push("size="+t.size),t.scale&&o.push("scale="+t.scale),t.markers&&o.push("markers="+t.markers),t.labels&&o.push("labels="+t.labels),t.paths&&o.push("paths="+t.paths),t.traffic&&o.push("traffic="+t.traffic);var a=n+o.join("&");t.success({url:a})}var a,i=this,o=[],n="https://restapi.amap.com/v3/staticmap?";o.push("key="+i.key),a=i.requestConfig,o.push("s="+a.s),o.push("platform="+a.platform),o.push("appname="+a.appname),o.push("sdkversion="+a.sdkversion),o.push("logversion="+a.logversion),t.location?e(t.location):i.getWxLocation(t,(function(t){e(t)}))},i.prototype.getInputtips=function(t){var e=this,a=e.requestConfig,i={key:e.key,s:a.s,platform:a.platform,appname:e.key,sdkversion:a.sdkversion,logversion:a.logversion};t.location&&(i["location"]=t.location),t.keywords&&(i["keywords"]=t.keywords),t.type&&(i["type"]=t.type),t.city&&(i["city"]=t.city),t.citylimit&&(i["citylimit"]=t.citylimit),wx.request({url:"https://restapi.amap.com/v3/assistant/inputtips",data:i,method:"GET",header:{"content-type":"application/json"},success:function(e){e&&e.data&&e.data.tips&&t.success({tips:e.data.tips})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})},i.prototype.getDrivingRoute=function(t){var e=this,a=e.requestConfig,i={key:e.key,s:a.s,platform:a.platform,appname:e.key,sdkversion:a.sdkversion,logversion:a.logversion};t.origin&&(i["origin"]=t.origin),t.destination&&(i["destination"]=t.destination),t.strategy&&(i["strategy"]=t.strategy),t.waypoints&&(i["waypoints"]=t.waypoints),t.avoidpolygons&&(i["avoidpolygons"]=t.avoidpolygons),t.avoidroad&&(i["avoidroad"]=t.avoidroad),wx.request({url:"https://restapi.amap.com/v3/direction/driving",data:i,method:"GET",header:{"content-type":"application/json"},success:function(e){e&&e.data&&e.data.route&&t.success({paths:e.data.route.paths,taxi_cost:e.data.route.taxi_cost||""})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})},i.prototype.getWalkingRoute=function(t){var e=this,a=e.requestConfig,i={key:e.key,s:a.s,platform:a.platform,appname:e.key,sdkversion:a.sdkversion,logversion:a.logversion};t.origin&&(i["origin"]=t.origin),t.destination&&(i["destination"]=t.destination),wx.request({url:"https://restapi.amap.com/v3/direction/walking",data:i,method:"GET",header:{"content-type":"application/json"},success:function(e){e&&e.data&&e.data.route&&t.success({paths:e.data.route.paths})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})},i.prototype.getTransitRoute=function(t){var e=this,a=e.requestConfig,i={key:e.key,s:a.s,platform:a.platform,appname:e.key,sdkversion:a.sdkversion,logversion:a.logversion};t.origin&&(i["origin"]=t.origin),t.destination&&(i["destination"]=t.destination),t.strategy&&(i["strategy"]=t.strategy),t.city&&(i["city"]=t.city),t.cityd&&(i["cityd"]=t.cityd),wx.request({url:"https://restapi.amap.com/v3/direction/transit/integrated",data:i,method:"GET",header:{"content-type":"application/json"},success:function(e){if(e&&e.data&&e.data.route){var a=e.data.route;t.success({distance:a.distance||"",taxi_cost:a.taxi_cost||"",transits:a.transits})}},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})},i.prototype.getRidingRoute=function(t){var e=this,a=e.requestConfig,i={key:e.key,s:a.s,platform:a.platform,appname:e.key,sdkversion:a.sdkversion,logversion:a.logversion};t.origin&&(i["origin"]=t.origin),t.destination&&(i["destination"]=t.destination),wx.request({url:"https://restapi.amap.com/v4/direction/bicycling",data:i,method:"GET",header:{"content-type":"application/json"},success:function(e){e&&e.data&&e.data.data&&t.success({paths:e.data.data.paths})},fail:function(e){t.fail({errCode:"0",errMsg:e.errMsg||""})}})},t.exports.AMapWX=i}}]);